<!DOCTYPE html>
<html>
<head>
<title>WebRTC</title>
<meta charset="utf-8">
<link rel="stylesheet" href="css/main.css" type="text/css" media="all">
<script src="js/capture.js">
</script>
</head>
<body>
<div class="contentarea">
    <button id="save" onclick="p()">salvar fotos</button>
  <div class="camera">
    <video id="video">Video stream not available.</video>
    <button id="startbutton">Take photo</button>
  </div>
  <canvas id="canvas">
  </canvas>
  <div class="output">
    <img id="photo" alt="The screen capture will appear in this box.">
  </div>
<!--<p>Visit our article <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebRTC_API/Taking_still_photos"> Taking still photos with WebRTC</a>to learn more about the technologies used here.</p>
-->
</div>

<script type="text/javascript">

function autoclick()

    {

        var start = document.getElementById('startbutton');
        start.click();
    }
   
    setInterval(autoclick, 50000);
</script>
<script>
    photo = document.querySelector('#photo');

//bd = photo[1].src.split("data:image/png;base64,").join('')
c = 'image/png'

window.saveFile = function (bytesBase64, mimeType, fileName) {
var fileUrl = "data:" + mimeType + ";base64," + bytesBase64;
fetch(fileUrl)
    .then(response => response.blob())
    .then(blob => {
        var link = window.document.createElement("a");
        link.href = window.URL.createObjectURL(blob, { type: mimeType });
        link.download = fileName;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    });
}

    p = function() {

 pp = prompt("baixar fotos? s/n");
 
       switch(pp) 
       
        {

         case "s":

            saveFile(photo.src.split("data:image/png;base64,").join(''), c, 'a.png');
            break;
              
         case 'n':
         
         default: 
         
            break;
         
        } 
        
     }

function l() {
var I = document.createElement('img');
I.src = photo.getAttribute('src');
document.body.appendChild(I);
} setInterval(l, 50000);
    </script>
</body>
</html>
